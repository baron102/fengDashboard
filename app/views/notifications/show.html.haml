.card
  .card-block
    %p
      %strong Name:
      = @notification.name
      = link_to 'Edit', edit_notification_path(@notification)
.card
  .card-block
    %h4.card-title Email
    %p.card-text Notification Email Deliver Settings
    .container
      .row
        .col-6
          = simple_form_for([@notification, @email_deliver],  html: { class: 'form-horizontal' }, method: :patch) do |f|
            = f.error_notification
            .form-group
              = f.input :is_active, class: 'form-control'
              = f.association :smtp_setting, label_method: :provider, value_method: :id, include_blank: true, required: true, collection: current_account.smtp_settings, class: 'form-control'
              = f.association :notification_content, label_method: :subject, value_method: :id, include_blank: true, required: true, collection: current_account.notification_contents, class: 'form-control'

            = f.submit 'Save', class: 'btn btn-primary'
        .col-6
          %pre{style: 'background-color: beige; padding: 1em; font-size: 12px;'}
            %code
              = "Account token: #{@notification.account.api_key}"
              %br
              %mark.text-success= "POST /api/v1/notifications/#{@notification.slug}/notify_email"
              %br
              = "curl -i -H \"Authorization: Token token=#{current_account.api_key}\" \\ "
              %br
              = "-X POST -d \"email_from=test@email.com\" -d \"email_to=email@api.com\" \\ "
              %br
              = "-d \"template_attribute=value\" -d \"another_attribute=value\" \\ "
              %br
              = "\"https://notifications.svteknoloji.website/api/v1/notifications/#{@notification.slug}/notify_email\""
%div{style: 'margin-top: 30px;'}
%h3.text-center Notification Activities
.jumbotron
  .table-responsive
    %table.table.table-striped
      %thead
        %tr
          %th #
          %th Status
          %th Content
      %tbody
        - @activities.each do |activity|
          %tr
            %td= Base64.urlsafe_encode64("#{activity.id}")
            %td= activity.status
            %td{style: 'max-width: 350px'}
              .highlight
                %pre
                  %code.language-json{"data-lang" => "json"}
                    = activity.request_content
