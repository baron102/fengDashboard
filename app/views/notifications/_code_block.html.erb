<% variables = @notification.try(:email_deliver).try(:notification_content).present? ? @notification.email_deliver.notification_content.content_variables : [] %>

<ul uk-tab class="uk-tab">
  <li class="uk-active"><a href="#">Curl</a></li>
  <li><a href="#">Ruby</a></li>
  <li><a href="#">PHP</a></li>
</ul>
<!-- Tab panes -->
<ul class="uk-switcher uk-margin">
  <li class="uk-active" id="curl" role="tabpanel">
    <pre>
      <code class="hljs bash" style="margin-left: -50px;">
      # Authorization, email_from and email_to are required

      <%= "curl -i -H \"Authorization: Token token=#{current_account.api_key}\" \\ " %>

      -X POST -d "email_from=test@email.com" -d "email_to=email@api.com" \
      <% variables.each do |variable| %>
        <%= "-d \"#{variable}=some_value\" \\ " %>
      <% end %>
      <%= "\"https://notifications.svteknoloji.website/api/v1/notifications/#{@notification.slug}/notify_email\"" %>
      </code>
    </pre>
  </li>
  <li class="tab-pane" id="ruby" role="tabpanel">
    <pre>
      <code class="hljs ruby" style="margin-left: -50px;">
      require 'httparty'

        query = {
          email_from:  'test@emaildomain.com', # required
          email_to:    'targetemail@email.com',  # required
        <% variables.each do |variable| %>
          <%= "#{variable}: 'some_value'," %>
        <% end %>
        }
        headers = {
          <%= "Authorization: \"Token token=#{current_account.api_key}\"" %>
        }

        HTTParty.post(
          '<%= "https://notifications.svteknoloji.website/api/v1/notifications/#{@notification.slug}/notify_email" %>',
          query: query, headers: headers
        )
      </code>
    </pre>
  </li>
  <li class="tab-pane" id="php" role="tabpanel">
    <pre>
      <code class="hljs php" style="margin-left: -50px;">
        <%= "<?php" %>
        // Your token
        $authToken = '<%= current_account.api_key %>';

        // The data to send to the API
        $postData = array(
            'email_from' =>  'test@emaildomain.com', // required
            'email_to' =>    'targetemail@email.com',  // required
          <% variables.each do |variable| %>
            <%= "'#{variable}' => 'some_value'," %>
          <% end %>
        );

        // Create the context for the request
        $context = stream_context_create(array(
            'http' => array(
                'method' => 'POST',
                'header' => "Authorization: Token {$authToken}\r\n",
                "Content-Type: application/json\r\n",
                'content' => json_encode($postData)
            )
        ));

        // Send the request
        $response = file_get_contents('<%= "https://notifications.svteknoloji.website/api/v1/notifications/#{@notification.slug}/notify_email" %>', FALSE, $context);

      </code>
    </pre>
  </li>
</ul>