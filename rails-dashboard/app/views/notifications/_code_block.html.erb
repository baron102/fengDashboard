<% variables = @notification.try(:email_deliver).try(:notification_content).present? ? @notification.email_deliver.notification_content.content_variables : [] %>

<ul uk-tab class="uk-tab">
  <li class="uk-active"><a href="#">Curl</a></li>
  <li><a href="#">Ruby</a></li>
  <li><a href="#">PHP</a></li>
</ul>
<!-- Tab panes -->
<ul class="uk-switcher uk-margin">
  <li class="uk-active" id="curl" role="tabpanel">
    <pre>
      <code class="hljs bash" style="margin-left: -50px;">
      <%= "curl -i -H \"Authorization: Token token=#{current_account.api_key}\" \\ " %>
      -H "Content-type: application/json" \
      -X POST -d '{ "variables":{ "<%= variables.first || 'variable' %>":"some_value"},
          "email":{ "to":["test@example.com"], "cc":["test@exapmle.com"], "bcc":["test@exapmle.com"], reply_to":["test@exapmle.com"], "from":"test@example.com" },
          "delivery":{ "time":"21:00", "date":"2018-02-12", "zone": "Central Time (US & Canada)" } }' \
      <%= "\"https://notifications.svteknoloji.website/api/v2/notifications/#{@notification.slug}/notifiers\"" %>

      # Delivery is optional, If delivery not set notification will send immediately.
      # <u><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank">See available timezones.</a></u>
      # Example JSON body
        {
          "variables":{
             "user_fullname":"Test User"
          },
          "email":{
             "to":["test@gmail.com", "test2@gmail.com"],
             "cc": ["cc@test.com"],
             "reply_to": ["reply@test.com"],
             "from":"from@test.com"
          },
          "delivery": {
            "time": "21:00",
            "date": "2018-02-12",
            "zone": "Central Time (US & Canada)"
          }
       }
      </code>
    </pre>
  </li>
  <li class="tab-pane" id="ruby" role="tabpanel">
    <pre>
      <code class="hljs ruby" style="margin-left: -50px;">
      require 'httparty'

        query = {
          email: {
            to: ['to@example.com'],
            cc: ['cc@test.com'],
            bcc: ['bcc@test.com'],
            from: 'from@test.com',
            reply_to: ['reply@test.com']
          },
          variables: {
          <% variables.each do |variable| %>
            <%= "#{variable}: 'some_value'," %>
          <% end %>
          },
          # optional
          delivery: {
            time: "21:00",
            date: "<%= Time.current.to_date %>",
            time_zone: "<%= Time.zone.name %>" # <u><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank">See available timezones.</a></u>
          }
        }
        headers = {
          <%= "Authorization: \"Token token=#{current_account.api_key}\"" %>
        }

        HTTParty.post(
          '<%= "https://notifications.svteknoloji.website/api/v2/notifications/#{@notification.slug}/notifiers" %>',
          query: query, headers: headers
        )
      </code>
    </pre>
  </li>
  <li class="tab-pane" id="php" role="tabpanel">
    <pre>
      <code class="hljs php" style="margin-left: -50px;">
        <%= "<?php" %>
        // Your token
        $authToken = '<%= current_account.api_key %>';

        // The data to send to the API
        $postData = array(
            'email' =>  array(
              'to' => ['to@example.com'],
              'cc' => ['cc@test.com'],
              'bcc' => ['bcc@test.com'],
              'from' => 'from@test.com',
              'reply_to': ['reply@test.com']
            ),
            'variables' => array(
            <% variables.each do |variable| %>
              <%= "'#{variable}' => 'some_value'," %>
            <% end %>
          ),
          // optional
          delivery => {
            'time' => "21:00",
            'date' => "<%= Time.current.to_date %>",
            'time_zone' => "<%= Time.zone.name %>" // <u><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank">See available timezones.</a></u>
          }
        );

        // Create the context for the request
        $context = stream_context_create(array(
            'http' => array(
                'method' => 'POST',
                'header' => "Authorization: Token {$authToken}\r\n",
                "Content-Type: application/json\r\n",
                'content' => json_encode($postData)
            )
        ));

        // Send the request
        $response = file_get_contents('<%= "https://notifications.svteknoloji.website/api/v1/notifications/#{@notification.slug}/notify_email" %>', FALSE, $context);

      </code>
    </pre>
  </li>
</ul>